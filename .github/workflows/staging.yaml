name: Vercel Staging Deployment

on:
    push:
        branches:
            - staging
    pull_request:
        branches:
            - staging

jobs:
    Deploy-Staging:
        runs-on: ubuntu-latest
        environment: Staging
        # These are public, don't worry
        env:
          VERCEL_ORG_ID: ${{ secrets.VERCEL_ORG_ID }}
          VERCEL_PROJECT_ID: ${{ secrets.VERCEL_PROJECT_ID }}
          REACT_APP_STRIPE_PUBLISHABLE_KEY: pk_test_51RoNSY52PGkk7WNvAXBljO2IYGljmOW5dLgiJ1cdnEHRcgkCtHDsuD3v93bvpE9mNpXNGUU0fq38banmvAP0rRwB00newRAyiz
          REACT_APP_FIREBASE_API_KEY: AIzaSyDO8Q9uHEFrPcS2ep-JABAN4eI0v1gQFww
          REACT_APP_FIREBASE_AUTH_DOMAIN: manele-io-testing.firebaseapp.com
          REACT_APP_FIREBASE_PROJECT_ID: manele-io-testing
          REACT_APP_FIREBASE_STORAGE_BUCKET: manele-io-testing.firebasestorage.app
          REACT_APP_FIREBASE_MESSAGING_SENDER_ID: 555349769112
          REACT_APP_FIREBASE_APP_ID: 1:555349769112:web:ebefecc513ed5b98e209ed
          REACT_APP_FIREBASE_MEASUREMENT_ID: G-7Z71ZS98GC
        steps:

            - uses: actions/checkout@v3

            - name: Install Vercel CLI
              run: npm install --global vercel

            - name: Pull Vercel Environment Information
              run: vercel pull --yes --environment=preview --token=${{ secrets.VERCEL_TOKEN }}

            - name: Build Project Artifacts
              run: vercel build --token=${{ secrets.VERCEL_TOKEN }}

            - name: Deploy Project Artifacts
              run: vercel deploy --prebuilt --token=${{ secrets.VERCEL_TOKEN }}